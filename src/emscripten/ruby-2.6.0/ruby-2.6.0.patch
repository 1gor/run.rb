diff --git a/configure.ac b/configure.ac
index 4e3f1ef..faf5dd9 100644
--- a/configure.ac
+++ b/configure.ac
@@ -225,8 +225,8 @@ AC_SUBST(LD)
 AS_IF([test "$GCC" = yes], [
     linker_flag=-Wl,
     : ${optflags=-O3}
-    gcc_major=`echo =__GNUC__ | $CC -E -xc - | sed '/^=/!d;s///'`
-    gcc_minor=`echo =__GNUC_MINOR__ | $CC -E -xc - | sed '/^=/!d;s///'`
+    gcc_major=`echo =__GNUC__ > /tmp/a.c; $CC -E -xc /tmp/a.c | sed '/^=/!d;s///'`
+    gcc_minor=`echo =__GNUC_MINOR__ > /tmp/a.c; $CC -E -xc /tmp/a.c | sed '/^=/!d;s///'`
     test -n "$gcc_major" || gcc_major=0
     test -n "$gcc_minor" || gcc_minor=0
     AS_CASE(["x$CC"], [xicc], [
